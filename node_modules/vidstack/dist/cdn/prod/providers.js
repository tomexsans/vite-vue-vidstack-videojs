import{i as l,a as p,w as ct,b as $,c as d,d as dt,$ as R,e as M,f as v,g as y,h as N,j as ut,E as lt,D as a,k,u as pt,l as C,o as O,m as g,n as gt,s as ft,p as _,q as mt}from"./maverick.js";const vt=navigator?.userAgent.toLowerCase(),yt=/iphone|ipad|ipod|ios|crios|fxios/i.test(vt),bt=/(iphone|ipod)/gi.test(navigator?.platform),Tt=!!window.chrome,H=!!window.safari||yt;function Et(){return!l(screen.orientation)&&p(screen.orientation.lock)&&p(screen.orientation.unlock)}function x(i){return i||(i=document.createElement("video")),i.canPlayType("application/vnd.apple.mpegurl").length>0}function D(i){return!!document.pictureInPictureEnabled&&!i.disablePictureInPicture}function V(i){return p(i.webkitSupportsPresentationMode)&&p(i.webkitSetPresentationMode)}async function St(){const i=document.createElement("video");return i.volume=.5,await ct(0),i.volume===.5}function wt(){return window?.MediaSource??window?.WebKitMediaSource}function kt(){return window?.SourceBuffer??window?.WebKitSourceBuffer}function F(){const i=wt();if(l(i))return!1;const t=i&&p(i.isTypeSupported)&&i.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),e=kt(),s=l(e)||!l(e.prototype)&&p(e.prototype.appendBuffer)&&p(e.prototype.remove);return!!t&&!!s}function I(i,t="preconnect"){const e=document.querySelector(`link[href="${i}"]`);if(!$(e))return!0;const s=document.createElement("link");return s.rel=t,s.href=i,s.crossOrigin="true",document.head.append(s),!0}const b={};function Ot(i){if(b[i])return b[i].promise;const t=dt(),e=document.querySelector(`script[src="${i}"]`);if(!$(e))return t.resolve(),t.promise;const s=document.createElement("script");return s.src=i,s.onload=()=>{t.resolve(),delete b[i]},s.onerror=()=>{t.reject(),delete b[i]},setTimeout(()=>document.head.append(s),0),t.promise}function q(i){return i==="use-credentials"?"include":d(i)?"same-origin":void 0}const _t=/\.(m4a|m4b|mp4a|mpga|mp2|mp2a|mp3|m2a|m3a|wav|weba|aac|oga|spx)($|\?)/i,It=new Set(["audio/mpeg","audio/ogg","audio/3gp","audio/mp4","audio/webm","audio/flac"]),Lt=/\.(mp4|og[gv]|webm|mov|m4v)(#t=[,\d+]+)?($|\?)/i,Pt=new Set(["video/mp4","video/webm","video/3gp","video/ogg","video/avi","video/mpeg"]),U=/\.(m3u8)($|\?)/i,K=new Set(["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"]);function B({src:i,type:t}){return typeof i=="string"&&U.test(i)||K.has(t)}function jt(i){return typeof window.MediaStream<"u"&&i instanceof window.MediaStream}const At=R('<audio preload="none" aria-hidden="true"></audio>'),$t=At;class Rt{canPlay({src:t,type:e}){return d(t)?_t.test(t)||It.has(e)||t.startsWith("blob:")&&e==="audio/object":e==="audio/object"}mediaType(){return"audio"}async load(){return new(await Promise.resolve().then(function(){return te})).AudioProvider(this.Qf)}render(t){return(()=>{const e=M($t);return v(()=>y(e,"controls",t.controls())),v(()=>y(e,"crossorigin",t.crossorigin())),N(e,s=>void(this.Qf=s)),e})()}}const Mt=R('<video preload="none" aria-hidden="true"></video>'),Nt=Mt;class X{canPlay(t){return d(t.src)?Lt.test(t.src)||Pt.has(t.type)||t.src.startsWith("blob:")&&t.type==="video/object"||B(t)&&x():t.type==="video/object"}mediaType(){return"video"}async load(t){return new(await Promise.resolve().then(function(){return ae})).VideoProvider(this.nc,t)}render(t){const e=ut(()=>t.poster()&&t.controls()?t.poster():null);return(()=>{const s=M(Nt);return v(()=>y(s,"controls",t.controls())),v(()=>y(s,"crossorigin",t.crossorigin())),v(()=>y(s,"poster",e())),N(s,r=>void(this.nc=r)),s})()}}const Y=class extends X{preconnect(){I("https://cdn.jsdelivr.net","preconnect")}canPlay({src:i,type:t}){return Y.supported&&d(i)&&(U.test(i)||K.has(t))}async load(i){return new(await Promise.resolve().then(function(){return ge})).HLSProvider(this.nc,i)}};let G=Y;G.supported=F();const L=Symbol(0),J=Symbol(0),u=Symbol(0),m=Symbol(0),Q=Symbol(0),T=Symbol(0),f=Symbol(0),W=Symbol(0);function Ct(i,t){for(let e=0,s=t.length;e<s;e++)if(E(t[e],i))return t[e];return null}function E(i,t){return t>=i.startTime&&t<i.endTime}function Ht(i,t,e){const s=i.toArray().find(r=>r.kind==="chapters"&&r.mode==="showing");if(s!==t){if(!s){e(null);return}s.readyState==2?e(s):(e(null),s.addEventListener("load",()=>e(s),{once:!0}))}}var z,Z,tt;class P extends lt{constructor(t){super(),this.id="",this.label="",this.language="",this.default=!1,this.Df=!1,this.Gf=0,this.If="disabled",this.Kf={},this.Jf=[],this.Ff=[],this.Hf=[],this[z]=0,this[Z]=null,this[tt]=null;for(const e of Object.keys(t))this[e]=t[e];this.type||(this.type="vtt"),t.content?import("./captions/prod.js").then(({parseText:e,VTTCue:s,VTTRegion:r})=>{t.type==="json"?this.Lf(t.content,s,r):e(t.content,{type:t.type}).then(({cues:h,regions:n})=>{this.Ff=h,this.Jf=n,this.Mf()})}):t.src||(this[u]=2)}static createId(t){return`id::${t.type}-${t.kind}-${t.src??t.label}`}get metadata(){return this.Kf}get regions(){return this.Jf}get cues(){return this.Ff}get activeCues(){return this.Hf}get readyState(){return this[u]}get mode(){return this.If}set mode(t){this.setMode(t)}addCue(t,e){let s=0,r=this.Ff.length;for(s=0;s<r&&!(t.endTime<=this.Ff[s].startTime);s++);s===r?this.Ff.push(t):this.Ff.splice(s,0,t),e?.type!=="cuechange"&&this[f]?.track.addCue(t),this.dispatchEvent(new a("add-cue",{detail:t,trigger:e})),E(t,this.Gf)&&this[m](this.Gf,e)}removeCue(t,e){const s=this.Ff.indexOf(t);if(s>=0){const r=this.Hf.includes(t);this.Ff.splice(s,1),this[f]?.track.removeCue(t),this.dispatchEvent(new a("remove-cue",{detail:t,trigger:e})),r&&this[m](this.Gf,e)}}setMode(t,e){this.If!==t&&(this.If=t,t==="disabled"?(this.Hf=[],this.Nf()):this.readyState===2?this[m](this.Gf,e):this.Of(),this.dispatchEvent(new a("mode-change",{detail:this,trigger:e})),this[T]?.())}[(z=u,Z=T,tt=f,m)](t,e){if(this.Gf=t,this.mode==="disabled"||!this.Ff.length)return;const s=[];for(let h=0,n=this.Ff.length;h<n;h++){const c=this.Ff[h];E(c,t)&&s.push(c)}let r=s.length!==this.Hf.length;if(!r){for(let h=0;h<s.length;h++)if(!this.Hf.includes(s[h])){r=!0;break}}this.Hf=s,r&&this.Nf(e)}[Q](){this.Df=!0,this.If!=="disabled"&&this.Of()}async Of(){if(!(!this.Df||!this.src||this[u]>0)){this[u]=1,this.dispatchEvent(new a("load-start"));try{const{parseResponse:t,VTTCue:e,VTTRegion:s}=await import("./captions/prod.js"),r=this[J]?.(),h=fetch(this.src,{headers:this.type==="json"?{"Content-Type":"application/json"}:void 0,credentials:q(r)});if(this.type==="json")this.Lf(await(await h).text(),e,s);else{const{errors:n,metadata:c,regions:o,cues:ot}=await t(h,{type:this.type,encoding:this.encoding});if(n[0]?.code===0)throw n[0];this.Kf=c,this.Jf=o,this.Ff=ot}this.Mf()}catch(t){this.Pf(t)}}}Mf(){if(this[u]=2,!this.src||this.type!=="vtt"){const e=this[f]?.track;if(e)for(const s of this.Ff)e.addCue(s)}const t=new a("load");this[m](this.Gf,t),this.dispatchEvent(t)}Pf(t){this[u]=3,this.dispatchEvent(new a("error",{detail:t}))}Lf(t,e,s){try{t=JSON.parse(t),t.regions&&(this.Jf=t.regions.map(r=>Object.assign(new s,r))),t.cues&&(this.Ff=t.cues.filter(r=>k(r.startTime)&&k(r.endTime)).map(r=>Object.assign(new e(0,0,""),r)))}catch(r){this.Pf(r)}}Nf(t){this.dispatchEvent(new a("cue-change",{trigger:t}))}}const xt=/captions|subtitles/;function Dt(i){return xt.test(i.kind)}function Vt(i,t=2){return Number(i.toFixed(t))}function j(i){return String(i).split(".")[1]?.length??0}function Ft(i,t,e){return Math.max(i,Math.min(e,t))}function qt(i){return i instanceof HTMLAudioElement}function Ut(i){return i instanceof HTMLVideoElement}function Kt(i){return qt(i)||Ut(i)}const S=Symbol(0),et=Symbol(0),Bt=Symbol(0),w=Symbol(0),Xt=Symbol(0),Yt=Symbol(0),Gt=Symbol(0),Jt=Symbol(0),Qt=Symbol(0),it=Symbol(0),A=Symbol(0);function st(i){return i instanceof Error?i:Error(JSON.stringify(i))}class rt{constructor(t){this.re=t}M(){l(this.ui)&&this.vi()}N(){k(this.ui)&&window.cancelAnimationFrame(this.ui),this.ui=void 0}vi(){this.ui=window.requestAnimationFrame(()=>{l(this.ui)||(this.re(),this.vi())})}}class Wt{constructor(t,e){this.o=t,this.lh=e,this.Sf=pt(),this.Qh=!1,this.Th=!1,this.Uh=!1,this.Rh=new rt(this.Xh.bind(this)),this.ri=void 0,this.si=void 0,this.Yh(),C(this.Zh.bind(this)),O(this.mh.bind(this))}get d(){return this.o.media}get cg(){return this.lh.delegate}mh(){this.Rh.N(),this.Sf.empty()}Xh(){const t=this.o.currentTime;this.lh.$store.currentTime()!==t&&this.Ph(t)}Yh(){this.Oh("loadstart",this.ec),this.Oh("abort",this.Vh),this.Oh("emptied",this._h),this.Oh("error",this.gc)}$h(){this.Th||(this.Sf.add(this.Oh("loadeddata",this.ai),this.Oh("loadedmetadata",this.bi),this.Oh("canplay",this.rc),this.Oh("canplaythrough",this.ci),this.Oh("durationchange",this.di),this.Oh("play",this.ei),this.Oh("progress",this.fi),this.Oh("stalled",this.gi),this.Oh("suspend",this.hi)),this.Th=!0)}ii(){this.Uh||(this.Sf.add(this.Oh("pause",this.ji),this.Oh("playing",this.ki),this.Oh("ratechange",this.li),this.Oh("seeked",this.mi),this.Oh("seeking",this.ni),this.Oh("ended",this.oi),this.Oh("volumechange",this.md),this.Oh("waiting",this.pi)),this.Uh=!0)}Oh(t,e){return g(this.d,t,e.bind(this))}ti(t){}Ph(t,e){this.cg.j("time-update",{detail:{currentTime:Math.min(t,this.lh.$store.seekableEnd()),played:this.d.played},trigger:e})}ec(t){if(this.d.networkState===3){this.Vh(t);return}this.$h(),this.cg.j("load-start",{trigger:t})}Vh(t){this.cg.j("abort",{trigger:t})}_h(){this.cg.j("emptied",{trigger:event})}ai(t){this.cg.j("loaded-data",{trigger:t})}bi(t){this.Wh(),this.ii(),this.cg.j("volume-change",{detail:{volume:this.d.volume,muted:this.d.muted}}),this.cg.j("loaded-metadata",{trigger:t}),H&&B(this.lh.$store.source())&&this.cg.te(this.Sh(),t)}Sh(){return{duration:this.d.duration,buffered:this.d.buffered,seekable:this.d.seekable}}Wh(){const t=!Number.isFinite(this.d.duration);this.cg.j("stream-type-change",{detail:t?"live":"on-demand"})}ei(t){this.lh.$store.canPlay&&this.cg.j("play",{trigger:t})}ji(t){this.d.readyState===1&&!this.Qh||(this.Qh=!1,this.Rh.N(),this.cg.j("pause",{trigger:t}))}rc(t){this.cg.te(this.Sh(),t)}ci(t){this.lh.$store.started()||this.cg.j("can-play-through",{trigger:t,detail:this.Sh()})}ki(t){this.Qh=!1,this.cg.j("playing",{trigger:t}),this.Rh.M()}gi(t){this.cg.j("stalled",{trigger:t}),this.d.readyState<3&&(this.Qh=!0,this.cg.j("waiting",{trigger:t}))}pi(t){this.d.readyState<3&&(this.Qh=!0,this.cg.j("waiting",{trigger:t}))}oi(t){this.Rh.N(),this.Ph(this.d.duration,t),this.cg.j("end",{trigger:t}),this.lh.$store.loop()?this.qi():this.cg.j("ended",{trigger:t})}Zh(){this.lh.$store.paused()&&g(this.d,"timeupdate",this.vc.bind(this))}vc(t){this.Ph(this.d.currentTime,t)}di(t){this.Wh(),this.lh.$store.ended()&&this.Ph(this.d.duration,t),this.cg.j("duration-change",{detail:this.d.duration,trigger:t})}md(t){this.cg.j("volume-change",{detail:{volume:this.d.volume,muted:this.d.muted},trigger:t})}mi(t){this.Ph(this.d.currentTime,t),this.cg.j("seeked",{detail:this.d.currentTime,trigger:t}),Math.trunc(this.d.currentTime)===Math.trunc(this.d.duration)&&j(this.d.duration)>j(this.d.currentTime)&&(this.Ph(this.d.duration,t),this.d.ended||this.lh.player.dispatchEvent(new a("media-play-request",{trigger:t})))}ni(t){this.cg.j("seeking",{detail:this.d.currentTime,trigger:t})}fi(t){this.cg.j("progress",{detail:{buffered:this.d.buffered,seekable:this.d.seekable},trigger:t})}qi(){gt(this.d.controls)&&(this.d.controls=!1),this.lh.player.dispatchEvent(new a("media-loop-request"))}hi(t){this.cg.j("suspend",{trigger:t})}li(t){this.cg.j("rate-change",{detail:this.d.playbackRate,trigger:t})}gc(t){const e=this.d.error;e&&this.cg.j("error",{detail:{message:e.message,code:e.code,mediaError:e},trigger:t})}}class zt{constructor(t,e){this.o=t,this.lh=e,this.Ih.onaddtrack=this.Kh.bind(this),this.Ih.onremovetrack=this.Lh.bind(this),this.Ih.onchange=this.Mh.bind(this),g(this.lh.audioTracks,"change",this.Nh.bind(this))}get Ih(){return this.o.media.audioTracks}Kh(t){const e=t.track;if(e.label==="")return;const s={id:e.id+"",label:e.label,language:e.language,kind:e.kind,selected:!1};this.lh.audioTracks[S](s,t),e.enabled&&(s.selected=!0)}Lh(t){const e=this.lh.audioTracks.getById(t.track.id);e&&this.lh.audioTracks[et](e,t)}Mh(t){let e=this.Jh();if(!e)return;const s=this.lh.audioTracks.getById(e.id);s&&this.lh.audioTracks[w](s,!0,t)}Jh(){return Array.from(this.Ih).find(t=>t.enabled)}Nh(t){const{current:e}=t.detail;if(!e)return;const s=this.Ih.getTrackById(e.id);if(s){const r=this.Jh();r&&(r.enabled=!1),s.enabled=!0}}}class ht{constructor(t){this.d=t}setup(t){new Wt(this,t),"audioTracks"in this.media&&new zt(this,t)}get type(){return""}get media(){return this.d}get paused(){return this.d.paused}get muted(){return this.d.muted}set muted(t){this.d.muted=t}get volume(){return this.d.volume}set volume(t){this.d.volume=t}get currentTime(){return this.d.currentTime}set currentTime(t){this.d.currentTime=t}get playsinline(){return this.d.hasAttribute("playsinline")}set playsinline(t){ft(this.d,"playsinline",t)}get playbackRate(){return this.d.playbackRate}set playbackRate(t){this.d.playbackRate=t}async play(){return this.d.play()}async pause(){return this.d.pause()}async loadSource({src:t},e){this.d.preload=e,jt(t)?this.d.srcObject=t:(this.d.srcObject=null,this.d.src=d(t)?t:window.URL.createObjectURL(t)),this.d.load()}}class Zt extends ht{constructor(){super(...arguments),this.$$PROVIDER_TYPE="AUDIO"}get type(){return"audio"}setup(t){super.setup(t),this.type==="audio"&&t.delegate.j("provider-setup",{detail:this})}get audio(){return this.d}}var te=Object.freeze({__proto__:null,AudioProvider:Zt});class ee{constructor(t,e){this.nc=t,this.lh=e,t.textTracks.onaddtrack=this.zf.bind(this),O(this.mh.bind(this))}zf(t){const e=t.track;if(!e||ie(this.nc,e))return;const s=new P({id:e.id,kind:e.kind,label:e.label,language:e.language,type:"vtt"});s[f]={track:e},s[u]=2,s[W]=!0;let r=0;const h=n=>{if(e.cues)for(let c=r;c<e.cues.length;c++)s.addCue(e.cues[c],n),r++};h(t),e.oncuechange=h,this.lh.textTracks.add(s,t),s.setMode(e.mode,t)}mh(){this.nc.textTracks.onaddtrack=null;for(const t of this.lh.textTracks){const e=t[f]?.track;e?.oncuechange&&(e.oncuechange=null)}}}function ie(i,t){return Array.from(i.children).find(e=>e.track===t)}class se{constructor(t,e){this.nc=t,this.d=e,this.Ma=(s,r)=>{this.d.delegate.j("picture-in-picture-change",{detail:s,trigger:r})},g(this.nc,"enterpictureinpicture",this.nh.bind(this)),g(this.nc,"leavepictureinpicture",this.oh.bind(this))}get active(){return document.pictureInPictureElement===this.nc}get supported(){return D(this.nc)}async enter(){return this.nc.requestPictureInPicture()}exit(){return document.exitPictureInPicture()}nh(t){this.Ma(!0,t)}oh(t){this.Ma(!1,t)}}class re{constructor(t,e){this.nc=t,this.d=e,this.If="inline",g(this.nc,"webkitpresentationmodechanged",this.Hh.bind(this))}get Gh(){return V(this.nc)}async Fh(t){this.If!==t&&this.nc.webkitSetPresentationMode(t)}Hh(){const t=this.If;this.If=this.nc.webkitPresentationMode,this.d.player?.dispatchEvent(new a("video-presentation-change",{detail:this.If,trigger:event})),["fullscreen","picture-in-picture"].forEach(e=>{(this.If===e||t===e)&&this.d.delegate.j(`${e}-change`,{detail:this.If===e,trigger:event})})}}class he{constructor(t){this.Eh=t}get active(){return this.Eh.If==="fullscreen"}get supported(){return this.Eh.Gh}async enter(){this.Eh.Fh("fullscreen")}async exit(){this.Eh.Fh("inline")}}class ne{constructor(t){this.Eh=t}get active(){return this.Eh.If==="picture-in-picture"}get supported(){return this.Eh.Gh}async enter(){this.Eh.Fh("picture-in-picture")}async exit(){this.Eh.Fh("inline")}}class nt extends ht{constructor(t,e){if(super(t),this.$$PROVIDER_TYPE="VIDEO",V(t)){const s=new re(t,e);this.fullscreen=new he(s),this.pictureInPicture=new ne(s)}else D(t)&&(this.pictureInPicture=new se(t,e))}get type(){return"video"}setup(t){super.setup(t),x(this.video)&&new ee(this.video,t),t.textRenderers[L](this.video),O(()=>{t.textRenderers[L](null)}),this.type==="video"&&t.delegate.j("provider-setup",{detail:this})}get video(){return this.d}}var ae=Object.freeze({__proto__:null,VideoProvider:nt});const oe=i=>mt(i);class ce{constructor(t){this.nc=t,this.ph=null,this.qh=null,this.jh={},this.kh=new Set}get instance(){return this.ph}setup(t,e){this.lh=e;const s=_(e.$store.streamType).includes("live"),r=_(e.$store.streamType).includes("ll-");this.ph=new t({lowLatencyMode:r,backBufferLength:r?4:s?8:void 0,renderTextTracksNatively:!1,...this.jh});const h=this.rh.bind(this);for(const n of Object.values(t.Events))this.ph.on(n,h);this.ph.on(t.Events.ERROR,this.gc.bind(this));for(const n of this.kh)n(this.ph);e.player.dispatchEvent(new a("hls-instance",{detail:this.ph})),this.ph.attachMedia(this.nc),this.ph.on(t.Events.AUDIO_TRACK_SWITCHED,this.sh.bind(this)),this.ph.on(t.Events.LEVEL_SWITCHED,this.th.bind(this)),this.ph.on(t.Events.LEVEL_LOADED,this.uh.bind(this)),this.ph.on(t.Events.NON_NATIVE_TEXT_TRACKS_FOUND,this.vh.bind(this)),this.ph.on(t.Events.CUES_PARSED,this.wh.bind(this)),e.qualities[A]=this.xh.bind(this),g(e.qualities,"change",this.gf.bind(this)),g(e.audioTracks,"change",this.yh.bind(this)),this.qh=C(this.zh.bind(this))}zh(){if(!this.lh.$store.live())return;const t=new rt(this.Ah.bind(this));return t.M(),t.N.bind(t)}Ah(){this.lh.$store.liveSyncPosition.set(this.ph?.liveSyncPosition??1/0)}rh(t,e){this.lh.player.dispatchEvent(new a(oe(t),{detail:e}))}vh(t,e){const s=new a(t,{detail:e});let r=-1;for(let h=0;h<e.tracks.length;h++){const n=e.tracks[h],c=n.subtitleTrack??n.closedCaptions,o=new P({id:`hls-${n.kind}${h}`,src:c?.url,label:n.label,language:c?.lang,kind:n.kind});o[u]=2,o[T]=()=>{o.mode==="showing"?(this.ph.subtitleTrack=h,r=h):r===h&&(this.ph.subtitleTrack=-1,r=-1)},n.default&&o.setMode("showing",s),this.lh.textTracks.add(o,s)}}wh(t,e){const s=this.lh.textTracks.getById(`hls-${e.track}`);if(!s)return;const r=new a(t,{detail:e});for(const h of e.cues)h.positionAlign="auto",s.addCue(h,r)}sh(t,e){const s=this.lh.audioTracks[e.id];s&&this.lh.audioTracks[w](s,!0,new a(t,{detail:e}))}th(t,e){const s=this.lh.qualities[e.level];s&&this.lh.qualities[w](s,!0,new a(t,{detail:e}))}uh(t,e){if(this.lh.$store.canPlay())return;const{type:s,live:r,totalduration:h}=e.details,n=new a(t,{detail:e});this.lh.delegate.j("stream-type-change",{detail:r?s==="EVENT"&&Number.isFinite(h)?"live:dvr":"live":"on-demand",trigger:n}),this.lh.delegate.j("duration-change",{detail:h,trigger:n});const c=this.ph.media;this.ph.currentLevel===-1&&this.lh.qualities[it](!0,n);for(const o of this.ph.audioTracks)this.lh.audioTracks[S]({id:o.id+"",label:o.name,language:o.lang||"",kind:"main"},n);for(const o of this.ph.levels)this.lh.qualities[S]({width:o.width,height:o.height,codec:o.codecSet,bitrate:o.bitrate},n);c.dispatchEvent(new a("canplay",{trigger:n}))}gc(t,e){if(e.fatal)switch(e.type){case"networkError":this.ph?.startLoad();break;case"mediaError":this.ph?.recoverMediaError();break;default:this.ph?.destroy(),this.ph=null;break}}xh(){this.ph&&(this.ph.currentLevel=-1)}gf(){const{qualities:t}=this.lh;!this.ph||t.auto||(this.ph[t.switch+"Level"]=t.selectedIndex,Tt&&(this.nc.currentTime=this.nc.currentTime))}yh(){const{audioTracks:t}=this.lh;this.ph&&this.ph.audioTrack!==t.selectedIndex&&(this.ph.audioTrack=t.selectedIndex)}Zf(){this.lh&&(this.lh.qualities[A]=void 0),this.ph?.destroy(),this.ph=null,this.qh?.(),this.qh=null}}class de{constructor(t,e,s){this.Bh=t,this.lh=e,this.re=s,this.Ch()}async Ch(){const t={onLoadStart:this.ec.bind(this),onLoaded:this.yd.bind(this),onLoadError:this.Dh.bind(this)};let e=await le(this.Bh,t);if(l(e)&&!d(this.Bh)&&(e=await ue(this.Bh,t)),!e)return null;if(!e.isSupported()){const s="[vidstack]: `hls.js` is not supported in this environment";return this.lh.player.dispatchEvent(new a("hls-unsupported")),this.lh.delegate.j("error",{detail:{message:s,code:4}}),null}return e}ec(){this.lh.player.dispatchEvent(new a("hls-lib-load-start"))}yd(t){this.lh.player.dispatchEvent(new a("hls-lib-loaded",{detail:t})),this.re(t)}Dh(t){const e=st(t);this.lh.player.dispatchEvent(new a("hls-lib-load-error",{detail:e})),this.lh.delegate.j("error",{detail:{message:e.message,code:4}})}}async function ue(i,t={}){if(!l(i)){if(t.onLoadStart?.(),i.prototype&&i.prototype!==Function)return t.onLoaded?.(i),i;try{const e=(await i())?.default;if(e&&e.isSupported)t.onLoaded?.(e);else throw Error("");return e}catch(e){t.onLoadError?.(e)}}}async function le(i,t={}){if(d(i)){t.onLoadStart?.();try{if(await Ot(i),!p(window.Hls))throw Error("");const e=window.Hls;return t.onLoaded?.(e),e}catch(e){t.onLoadError?.(e)}}}const pe="https://cdn.jsdelivr.net";class at extends nt{constructor(){super(...arguments),this.$$PROVIDER_TYPE="HLS",this.ih=null,this.Ob=new ce(this.video),this.hh=`${pe}/npm/hls.js@^1.0.0/dist/hls.min.js`}get ctor(){return this.ih}get instance(){return this.Ob.instance}get type(){return"hls"}get canLiveSync(){return!0}get config(){return this.Ob.jh}set config(t){this.Ob.jh=t}get library(){return this.hh}set library(t){this.hh=t}preconnect(){d(this.hh)&&I(this.hh)}setup(t){super.setup(t),new de(this.hh,t,e=>{this.ih=e,this.Ob.setup(e,t),t.delegate.j("provider-setup",{detail:this});const s=_(t.$store.source);s&&this.loadSource(s)})}async loadSource({src:t}){d(t)&&this.Ob.instance?.loadSource(t)}onInstance(t){const e=this.Ob.instance;return e&&t(e),this.Ob.kh.add(t),()=>this.Ob.kh.delete(t)}destroy(){this.Ob.Zf()}}at.supported=F();var ge=Object.freeze({__proto__:null,HLSProvider:at});export{Rt as A,Ht as B,j as C,St as D,A as E,G as H,H as I,Xt as L,it as S,P as T,X as V,S as a,et as b,Et as c,Jt as d,Bt as e,Yt as f,q as g,Gt as h,Kt as i,w as j,Qt as k,st as l,Q as m,m as n,Dt as o,I as p,f as q,L as r,W as s,J as t,T as u,bt as v,Ft as w,Ct as x,E as y,Vt as z};
